{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "ensure-test-workspace",
      "type": "shell",
      "command": "mkdir -p ${workspaceFolder}/.local/test-workspace && cp -r ${workspaceFolder}/examples/. ${workspaceFolder}/.local/test-workspace/",
      "presentation": { "reveal": "never" }
    },
    {
      "label": "watch",
      "dependsOn": [
        "ensure-test-workspace",
        "watch:core:tsc",
        "watch:core:esbuild",
        "watch:webview"
      ],
      "presentation": { "reveal": "never" },
      "group": { "kind": "build", "isDefault": true }
    },
    {
      "label": "watch:core:esbuild",
      "type": "shell",
      "command": "devbox",
      "args": ["run", "--", "node", "packages/core/esbuild.js", "--watch"],
      "group": "build",
      "problemMatcher": "$esbuild-watch",
      "isBackground": true,
      "presentation": { "group": "watch", "reveal": "never" }
    },
    {
      "label": "watch:core:tsc",
      "type": "shell",
      "command": "devbox",
      "args": ["run", "--", "pnpm", "--filter", "@md-tasks/core", "run", "check-types:watch"],
      "group": "build",
      "problemMatcher": "$tsc-watch",
      "isBackground": true,
      "presentation": { "group": "watch", "reveal": "never" }
    },
    {
      "label": "watch:webview",
      "type": "shell",
      "command": "devbox",
      "args": ["run", "--", "pnpm", "--filter", "@md-tasks/webview", "run", "watch"],
      "group": "build",
      "problemMatcher": {
        "owner": "vite",
        "pattern": {
          "regexp": "^$",
          "file": 1,
          "line": 2,
          "column": 3,
          "message": 4
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^build started",
          "endsPattern": "^built in"
        }
      },
      "isBackground": true,
      "presentation": { "group": "watch", "reveal": "never" }
    },
    {
      "label": "watch-tests",
      "type": "shell",
      "command": "devbox",
      "args": ["run", "--", "node", "packages/core/esbuild.e2e.js", "--watch"],
      "group": "build",
      "problemMatcher": "$tsc-watch",
      "isBackground": true,
      "presentation": { "reveal": "never", "group": "watchers" }
    },
    {
      "label": "tasks: watch-tests",
      "dependsOn": ["watch", "watch-tests"],
      "problemMatcher": []
    }
  ]
}
